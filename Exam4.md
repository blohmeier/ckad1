# Exam 4: Observability #
<details><summary>Exam link</summary>
https://cloudacademy.com/lab/ckad-practice-exam-observability/?context_resource=lp&context_id=3086
</p></details>

### Check 1: Create Nginx Pod with Liveness HTTP Get Probe ###
<details><summary>
Create a new Pod named nginx in the ca1 namespace using the nginx image. Ensure that the pod listens on port 80 and configure it with a Liveness HTTP GET probe with the following configuration:
<ul><li>Probe Type: httpGet</li>
<li>Path: /</li>
<li>Port: 80</li>
<li>Initial delay seconds: 10</li>
  <li>Polling period seconds: 5</li></ul>
</summary>
<p>
  
```bash
k run nginx -n ca1 --image=nginx --restart=Never --port=80 $dy > 1.yml
vim 1.yml
apiVersion: v1
kind: Pod 
metadata:
  creationTimestamp: null
  labels:
    run: nginx
  name: nginx
  namespace: ca1 
spec:
  containers:
  - image: nginx
    name: nginx
    ports:
    - containerPort: 80
    resources: {}
    livenessProbe:		#add from here to 'end'
      httpGet:
        path: /
        port: 80
      initialDelaySeconds: 10
      periodSeconds: 5	#end
  dnsPolicy: ClusterFirst
  restartPolicy: Never
status: {}
k create -f 1.yml
```
  
</p>
</details>

### Check 2: Hosting Service Not Working ###
A Service in the hosting Namespace is not responding to requests. Determine which Service is not working and resolve the underlying issue so the Service begins responding to requests.

<details><summary>show</summary><p>

```bash
#List all svc in -n:
k get svc -n hosting -o wide
#see if the Services have any Pod Endpoints associated with them:
k -n hosting get ep
#shows web2 has no eps, meaning it can't serve requests. List pods for web2 using "--selector" (-l):
k -n hosting get pods -l app=web2
#shows 2 pods matching so no issue with labels (?). Naming convention suggests they're part of a deployment. Problem: shows are not in "READY" state. Find out why with:
k -n hosting describe pods -l app=web2
#reveals "Readiness probe failed..." for both pods. Reviewing Containers.Readiness, request sent to port 30, but "Port: 80/TCP" a few lines above. Must use 'edit' to change readiness probe so request is sent to port 80:
k edit deploy -n hosting web2
  
```
</p>
</details>

### Check 3: Pod Log Analysis ###
Update and deploy the provided /home/ubuntu/md5er-app.yaml manifest file, adding a second container named c2 to the existing md5er Pod. The c2 container will run the same bash image that the c1 container already uses. The c2 container must mount the existing vol1 volume in read only mode, and such that it can execute the following bash script:

```bash
 for word in $(</data/file.txt)
 do 
 echo $word | md5sum | awk '{print $1}'
 done
```

<p>Note: The above command will simply generate an MD5 hash for each individual word found within the /data/file.txt file (generated by the c1 container).</p>

<p>Once deployed, run the following command to save the stdout output of the c2 container:</p>

```bash
kubectl logs -n app2 md5er c2 > /home/ubuntu/md5er-output.log
```

<details><summary>show</summary>
<p>
  
```bash
cp /home/ubuntu/md5er-app.yaml /home/ubuntu/md5er-app-original.yaml
vim /home/ubuntu/md5er-app.yaml
apiVersion: v1
kind: Pod 
metadata:
 name: md5er
 namespace: app2
spec:
 restartPolicy: Never
 volumes:
 - name: vol1
   emptyDir: {}
 containers:
 - name: c1
   image: bash
   env:
   - name: DATA
     valueFrom:
      configMapKeyRef:
       name: cm1 
       key: data
   volumeMounts:
   - name: vol1
     mountPath: /data
   command: ["/usr/local/bin/bash", "-c", "echo $DATA > /data/file.txt"] ## Add from line below to end
 - name: c2
   image: bash
   volumeMounts:
   - name: vol1
     mountPath: /data
     readOnly: true
   command:
     - "/usr/local/bin/bash"
     - "-c"
     - |
       for word in $(</data/file.txt)
       do 
       echo $word | md5sum | awk '{print $1}'
       done					

k apply -f /home/ubuntu/md5er-app.yaml
k logs -n app2 md5er c2 > /home/ubuntu/md5er-output.log
  
```
</p>
</details>















#TEMPLATE
<details><summary>show</summary>
<p>
  
```bash

```
</p>
</details>
